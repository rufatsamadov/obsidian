Snort has 2 alert modes full and fast(1 line)
Cisco Talos provides us with free snort rules
![[Pasted image 20241002135808.png]]
==[1:2009702:5]==
==[ what triggers the alert(e.g rules):rule id:revision id(version number of the rule)]==
cat alert | grep \'\^\[\*\*\].\*\[\*\*\]\$\'   -> to bring all alert names
![[Pasted image 20241002140802.png]]
\[\*\*\]=nose of the pig that represents mascott of snort
grep=generic regular expression pattern
***
Analysing the number of alerts:
![[Pasted image 20241002141358.png]]
Rare alerts are "quwlamag" of our adversary
admin$=hidden admin share in SMB (dollar sign makes it hidden)
In our case it is GPL NETBIOS SMB IPC$
Old windows systems use port 139 for SMB
We look at the events of interests:
![[Pasted image 20241002142735.png]]
\*\*\*AP\*\*\* means ACK and PUSH bits are set
We use wireshark to read the SMB hex




Cont-ed...





***
We make the USB flash drive read-only because we do not want its contents to change because it is an evidence
But in Tsurugi it uses software write blocker (more strong way)
dd command copy data in linux
dcfldd same as dd but a lot more faster
conv=sync-when it hits bad sector it just writes same amount of null data to avoid errors
noerror-when it hits bad sector it doesnt give us an error

Cont-ed...



***
Splunk parses all kinds of logs so it is expensive
But ELK cant parse all kinds of logs
"Dirty word lists"=list of strings that we should search those strings when investigating because bad guys use bad words
PCRE=perl compatible reg ex
RAT=remote administration tool






